#!/bin/bash

. /medianet/lib/mn_includes

. "$MEDIANETCONF"



OLDWD=`pwd`
cd /medianet/overlay/usr/lib/systemd/system/
for i in *.service ; do 
  echo "$i: "
  echo $SYSTEMD_ENABLE | grep $i > /dev/null && {
    sudo systemctl --quiet is-enabled "$i" && {
      echo -e "\talready enabled."
    } || {
      echo -ne "\tenabling..."
      sudo systemctl enable "$i" | tr "\n" " " && success || failure
    }
  } || {
    sudo systemctl --quiet is-active "$i" 2> /dev/null && {
      echo -ne "\tstopping..." 
      sudo systemctl stop "$i" | tr "\n" " " && success || failure
    } || echo -e "\talready stopped."
    sudo systemctl --quiet is-enabled "$i" 2> /dev/null && {
      echo -ne "\tdisabling..."
      sudo systemctl disable "$i" | tr "\n " " " && success || failure
    } || echo -e "\talready disabled."
  }
done
cd "$OLDWD"
