#!/bin/bash

echo -n "Creating group medianet..."
/usr/sbin/groupadd medianet && echo " succeeded." || echo " failed."
echo -n "Creating home directory..."
mkdir /home/medianet && echo " succeeded." || echo " failed."
echo -n "Creating user medianet..."
/usr/sbin/useradd -c "medianet Maintenance account" -g medianet -G users,audio -d /home/medianet medianet && echo " succeeded." || echo " failed."
echo -n "Changing ownership of home directory..."
chown -R medianet:medianet /home/medianet && echo " succeeded." || echo " failed."
echo -n "Changing login shell to /bin/bash..."
chsh -s /bin/bash medianet && echo " succeeded." || echo " failed."
echo -n "Creating .ssh dir..."
mkdir /home/medianet/.ssh && echo " succeeded." || echo " failed."
echo -n "Installing public key for SSH authorization..."
cp /medianet/medianet.pub /home/medianet/.ssh/authorized_keys && echo " succeeded." || echo " failed."
echo -n "Adding medianet user to sudoers..."
ln -rfs /medianet/overlay/etc/sudoers.d/10_medianet-nopasswd /etc/sudoers.d && echo " succeeded." || echo " failed."
echo -n "Creating /is_writable test file..."
touch /is_writable && chmod 1666 /is_writable && echo " succeeded." || echo " failed."


