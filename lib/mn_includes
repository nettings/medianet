function scream {
  echo
  echo -e "\033[1;1m$1\033[0m"
}

function success {
  echo  -e " \033[1;32msucceeded.\033[0m"
}

function failure {
	ERR=$?
	ERRSTR=""
	if [[ $ERR != 0 ]] ; then
		ERRSTR=" (return code $ERR)"
	fi
	echo  -e " \033[1;31mfailed$ERRSTR. $@\033[0m"
}

function bail {
	ERR=$?
	ERRSTR=""
	if [[ $ERR != 0 ]] ; then
		ERRSTR=" (return code $ERR)"
	fi
	echo -e "\033[1;31mFatal error \"$@\"$ERRSTR ... Exiting.\033[0m"
  exit 1
}

function needroot {
	if [ "$EUID" -ne 0 ] ; then
		echo -e "\033[1;31mYou must be root to run $0.\033[0m"
	exit 2
	fi
}

# legacy globals

MEDIANETCONF="/medianet/config/this/medianet.conf"

# globals
PREFIX=/medianet

CONFIG_INCLUDE=/etc/mn_config
CONF_FILE_MODHOST=/etc/mod-host.conf
CONF_FILE_MODHOST_STATE=/local/mod-host.state
CONF_FILE_ZITALRX=/etc/zita-lrx.conf
CONF_FILE_BOOT=/boot/medianet.txt
CONF_FILE_PERMISSIONS="$PREFIX"/permissions.medianet
SYSTEM_CONFIG="$PREFIX"/config/this/medianet.json
SYSTEMD_UNIT_DIR=/etc/systemd/system
SYSTEMD_UNITS_LOCAL="$PREFIX"/systemd

# binaries
APTGET=/usr/bin/apt-get
CHOWN=/bin/chown
CHMOD=/bin/chmod
CHSH=/usr/bin/chsh
CMP=/usr/bin/cmp
CP=/bin/cp
DIRNAME=/usr/bin/dirname
DPHYSSWAPFILE=/sbin/dphys-swapfile
DPKGRECONFIGURE=/usr/sbin/dpkg-reconfigure
FIND=/usr/bin/find
GIT=/usr/bin/git
GREP=/bin/grep
GROUPADD=/usr/sbin/groupadd
HOSTNAMEBIN=/bin/hostname
INOTIFYWAIT=/usr/bin/inotifywait
IPBIN=/sbin/ip
MN_CONFIG_UPDATE="$PREFIX"/overlay/usr/local/bin/mn_config_update
MKDIR=/bin/mkdir
MV=/bin/mv
PASSWD=/usr/bin/passwd
READLINK=/bin/readlink
RM=/bin/rm
SED=/bin/sed
SLEEP=/bin/sleep
SWAPOFF=/sbin/swapoff
SYSTEMCTL=/bin/systemctl
STAT=/usr/bin/stat
TAR=/bin/tar
TR=/usr/bin/tr
UPDATELOCALE=/usr/sbin/update-locale
USERADD=/usr/sbin/useradd
USERDEL=/usr/sbin/userdel
WGET=/usr/bin/wget
XARGS=/usr/bin/xargs

# dynamic helper variables
# don't barf if \$0 starts with dash (as for login shell)
PROGNAME=`basename -- "$0"`

# make config variables available
. $CONFIG_INCLUDE
